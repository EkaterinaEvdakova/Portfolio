# Проект "Восстановление золота из золотосодержащей руды"

Компания разрабатывает решения для эффективной работы промышленных предприятий.
Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. Имеются данные с параметрами добычи и очистки.
Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

Когда добытая руда проходит первичную обработку, получается дроблёная смесь. Её отправляют на флотацию (обогащение) и двухэтапную очистку.

## Описание данных
### Технологический процесс
Rougher feed — исходное сырье
Rougher additions (или reagent additions) — флотационные реагенты: Xanthate, Sulphate, Depressant
Xanthate — ксантогенат (промотер, или активатор флотации);
Sulphate — сульфат (на данном производстве сульфид натрия);
Depressant — депрессант (силикат натрия).
Rougher process (англ. «грубый процесс») — флотация
Rougher tails — отвальные хвосты
Float banks — флотационная установка
Cleaner process — очистка
Rougher Au — черновой концентрат золота
Final Au — финальный концентрат золота
Параметры этапов
air amount — объём воздуха
fluid levels — уровень жидкости
feed size — размер гранул сырья
feed rate — скорость подачи
## Наименование признаков
Наименование признаков:
[этап].[тип_параметра].[название_параметра]
Пример: rougher.input.feed_ag
Возможные значения для блока [этап]:
rougher — флотация
primary_cleaner — первичная очистка
secondary_cleaner — вторичная очистка
final — финальные характеристики
Возможные значения для блока [тип_параметра]:
input — параметры сырья
output — параметры продукта
state — параметры, характеризующие текущее состояние этапа
calculation — расчётные характеристики
##План работы:

<b>Подготовка данных:</b>

- Проведение исследовательского анализа данных
- Построение и обучение модели.
- Подготовка данных В ходе предподготовки данных для дальнейшего анализа:
- Удалены пропуски (10% данных).
- Удалены сильно коррелируюшие признаки (корреляция более 0,85).
- Удалены признаки, которых не было в тесте.
- Добавлены таргетированые признаки в тестовую выборку.
- Была проведена проверка на дублика
- Удалили аномалии. 

В тестовой выборке отсутсвовали следующие признаки:
- Целевые признаки. Они были восстановлены из полной выборки.
- Признаки, содержащие данные неизвестные до начала технологического процесса. Это логично, так как предсказание модель делает до начала работ.
- Рассчетных данных. Эти данные могли привести к утечке целевого признака. Была проведена проверка, что эффективность обогащения рассчитана правильно.

<b>Анализ данных</b>

Были получены графики, описывающие как меняется концентрация металлов (Au, Ag, Pb) на различных этапах очистки.Видно что концентрация золота растет (цель технологического процесса - восстановление золота). Концентраия ag падает, концентрация pb - растет, но незначительно, по сравнению с концентрацией золота.

Было проведено сравнение распределения размеров гранул сырья на обучающей и тестовой выборках. Данные в обучающей и тестовой выборке близки по своим значениям.

Исследована суммарная концентрация всех веществ на разных стадиях: в сырье, в черновом и финальном концентратах. На финальной стадии концентрация всех веществ максимальная. С каждым этапом - концентрация веществ увеличивается.

<b>Построение моделей и оценка их работы</b>

Для решения задачи использовалась метрика качества — sMAPE. 

Для оценки работы модели использовалась кросс-валидация с 3 блоками. 

Модели, которые были обучены: RidgeCV, дерево решений, случайный лес. Лучшую значение метрки качества дала модель случайного леса (RandomForestRegressor) - 4.6. Эта модель и была использована для оценки тестовго набора данных. sMARE теста равна 5.2.